<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="iOS高级工程师"><title>（非越狱版）iOS微信聊天加密插件 （二） | 王孟发</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">（非越狱版）iOS微信聊天加密插件 （二）</h1><a id="logo" href="/.">王孟发</a><p class="description">跟着梦想去飞翔~   https://github.com/wmf00032</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about.html"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">（非越狱版）iOS微信聊天加密插件 （二）</h1><div class="post-meta">Sep 6, 2016<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/09/06/wechat-secret-2/" href="/2016/09/06/wechat-secret-2/#comments" class="ds-thread-count"></a><a data-disqus-identifier="2016/09/06/wechat-secret-2/" href="/2016/09/06/wechat-secret-2/#disqus_thread" class="disqus-comment-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#定位首页Controller"><span class="toc-number">1.</span> <span class="toc-text">定位首页Controller</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#新建Tweak项目"><span class="toc-number">2.</span> <span class="toc-text">新建Tweak项目</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#一键自动化脚本"><span class="toc-number">3.</span> <span class="toc-text">一键自动化脚本</span></a></li></ol></div></div><div class="post-content"><h1 id="定位首页Controller"><a href="#定位首页Controller" class="headerlink" title="定位首页Controller"></a>定位首页Controller</h1><p>前面我们已经找到如何获取<code>WeChat</code>全部联系人的方法，下面我们来这手新建项目并且尝试着将其编译成我们自己的动态库，并将其注入到<code>WeChat</code>二进制文件之中，然后打包安装到非越狱手机上面。</p>
<p>先明确一下我们的目标，现在我想在<code>WeChat</code>首页左上角增加一个按钮，按钮点击按钮进入一个我们自己写的新界面，里面能够展示所有的联系人列表。</p>
<p><img src="https://github.com/wmf00032/imagesRecource/blob/master/wechat2_images/%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%87.png?raw=true" width="320" height="568" alt="图片名称" align="center"></p>
<p>要想在首页左上角增加一个按钮，就必须要先回去到首页<code>Controller</code>。同理通过<code>Cycript</code>调试寻找首页<code>Controller</code> ：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">cy<span class="comment"># UIApp.keyWindow.recursiveDescription().toString()</span></div><div class="line">`<span class="variable">&lt;iConsoleWindow: 0x156f59a0; baseClass = UIWindow; frame = (0 0; 320 568); autoresize = W+H; gestureRecognizers = &lt;NSArray: 0x156f6ab0&gt;</span>; layer = <span class="variable">&lt;UIWindowLayer: 0x156f5de0&gt;</span>&gt;</div><div class="line">   |<span class="string"> &lt;UILayoutContainerView: 0x16be77d0; frame = (0 0; 320 568); autoresize = W+H; layer = &lt;CALayer: 0x16be0790&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string"> &lt;UITransitionView: 0x16f27a60; frame = (0 0; 320 568); clipsToBounds = YES; autoresize = W+H; layer = &lt;CALayer: 0x16cd07b0&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;UIViewControllerWrapperView: 0x16ca4380; frame = (0 0; 320 568); autoresize = W+H; layer = &lt;CALayer: 0x1697abe0&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;UILayoutContainerView: 0x16bcb620; frame = (0 0; 320 568); autoresize = W+H; gestureRecognizers = &lt;NSArray: 0x16aaef60&gt;; layer = &lt;CALayer: 0x16a7a260&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;UINavigationTransitionView: 0x16b5bd20; frame = (0 0; 320 568); clipsToBounds = YES; autoresize = W+H; layer = &lt;CALayer: 0x1706fe30&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;UIViewControllerWrapperView: 0x16bf24a0; frame = (0 0; 320 568); layer = &lt;CALayer: 0x16bf2510&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;MMUIHookView: 0x16fddc40; frame = (0 0; 320 519); layer = &lt;CALayer: 0x16cc2910&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;MMMainTableView: 0x15df4600; baseClass = UITableView; frame = (0 0; 320 568); clipsToBounds = YES; gestureRecognizers = &lt;NSArray: 0x16a131b0&gt;; layer = &lt;CALayer: 0x16a13140&gt;; contentOffset: &#123;0, -64&#125;; contentSize: &#123;320, 499&#125;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;UIView: 0x16c88190; frame = (0 -64; 320 568); autoresize = W+H; layer = &lt;CALayer: 0x16c88200&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;UIView: 0x1696ba60; frame = (0 0; 320 64); alpha = nan; tag = 251658531; layer = &lt;CALayer: 0x16c249e0&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;UITableViewWrapperView: 0x16b8fae0; frame = (0 0; 320 504); gestureRecognizers = &lt;NSArray: 0x16a20600&gt;; layer = &lt;CALayer: 0x16bab380&gt;; contentOffset: &#123;0, 0&#125;; contentSize: &#123;320, 504&#125;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;NewMainFrameCell: 0x16aca000; baseClass = UITableViewCell; frame = (0 369; 320 65); autoresize = W; gestureRecognizers = &lt;NSArray: 0x169c57b0&gt;; layer = &lt;CALayer: 0x16b5ce80&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;UITableViewCellContentView: 0x16b5cf70; frame = (0 0; 320 65); gestureRecognizers = &lt;NSArray: 0x17056550&gt;; layer = &lt;CALayer: 0x16b5cfe0&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;UIView: 0x16cbee30; frame = (0 0; 320 65); layer = &lt;CALayer: 0x16cb3eb0&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;MainFrameItemView: 0x16ce2000; frame = (0 0; 320 65); tag = 1001; layer = &lt;CALayer: 0x16ce20a0&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;MMHeadImageView: 0x16ce20d0; frame = (10 10; 45 45); layer = &lt;CALayer: 0x16f8bf50&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;MMUILongPressImageView: 0x16f8bf80; baseClass = UIImageView; frame = (0 0; 45 45); opaque = NO; layer = &lt;CALayer: 0x16f8c010&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;UIButton: 0x16f8c040; frame = (0 0; 45 45); hidden = YES; opaque = NO; layer = &lt;CALayer: 0x16c79240&gt;&gt;</span></div><div class="line">   |<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string">    </span>|<span class="string"> &lt;UIImageView: 0x16c8dd30; frame = (0 0; 45 45); clipsToBounds = YES; opaque = NO; userInteractionEnabled = NO; layer = &lt;CALayer: 0x16c8ddb0&gt;&gt;</span></div></pre></td></tr></table></figure>
<p>其中当前界面的<code>tableview</code>信息如下：</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">MMMainTableView:</span> <span class="attr">0x15df4600</span>; <span class="attr">baseClass</span> = <span class="string">UITableView;</span> <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">320</span> <span class="attr">568</span>); <span class="attr">clipsToBounds</span> = <span class="string">YES;</span> <span class="attr">gestureRecognizers</span> = &lt;<span class="attr">NSArray:</span> <span class="attr">0x16a131b0</span>&gt;</span>; layer = <span class="tag">&lt;<span class="name">CALayer:</span> <span class="attr">0x16a13140</span>&gt;</span>; contentOffset: </span><span class="template-variable">&#123;0, -64&#125;</span><span class="xml">; contentSize: </span><span class="template-variable">&#123;320, 499&#125;</span><span class="xml">&gt;</span></div><div class="line">接下来通过nextResponder往下寻找：</div><div class="line">cy# [#0x15df4600 nextResponder]</div><div class="line">#"<span class="tag">&lt;<span class="name">MMUIHookView:</span> <span class="attr">0x16fddc40</span>; <span class="attr">frame</span> = <span class="string">(0</span> <span class="attr">0</span>; <span class="attr">320</span> <span class="attr">519</span>); <span class="attr">layer</span> = &lt;<span class="attr">CALayer:</span> <span class="attr">0x16cc2910</span>&gt;</span>&gt;"</div><div class="line">cy# [#0x16fddc40 nextResponder]</div><div class="line">#"<span class="tag">&lt;<span class="name">NewMainFrameViewController:</span> <span class="attr">0x15dbde00</span>&gt;</span>"</div></pre></td></tr></table></figure>
<p>好了，原来首页<code>Controller</code>就是<code>NewMainFrameViewController</code></p>
<h1 id="新建Tweak项目"><a href="#新建Tweak项目" class="headerlink" title="新建Tweak项目"></a>新建Tweak项目</h1><p>选择<code>iOSOpenDev</code> -&gt;<code>Logos Tweak</code> </p>
<p><img src="https://github.com/wmf00032/imagesRecource/blob/master/wechat2_images/%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%872.png?raw=true" alt=""></p>
<p>当然你需要先安装 <code>iOSOpenDev</code> ，你也可以选择使用命令行新建Tweak项目，就像这样：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">wangmengfa:~ Mango$ /opt/theos/bin/nic.pl</div><div class="line"><span class="section">NIC 2.0 - New Instance Creator</span></div><div class="line">------------------------------</div><div class="line">  [1.] iphone/application</div><div class="line">  [2.] iphone/library</div><div class="line">  [3.] iphone/preference<span class="emphasis">_bundle</span></div><div class="line">  [4.] iphone/tool</div><div class="line">  [5.] iphone/tweak</div><div class="line">Choose a Template (required):</div></pre></td></tr></table></figure>
<p>选择<code>iphone/tweak</code> ，然后按照提示一步一步往下就能新建一个Tweak项目。（关于<code>iOSOpenDev</code> 和<code>Theos</code>的安装请自行百度）</p>
<p>新建的项目如下：</p>
<p><img src="https://github.com/wmf00032/imagesRecource/blob/master/wechat2_images/%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%873.png?raw=true" alt=""></p>
<p>点击<code>command+B</code> 运行报一下错误</p>
<p><img src="https://github.com/wmf00032/imagesRecource/blob/master/wechat2_images/%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%874.png?raw=true" alt=""></p>
<p>只要按照<code>.xm</code>文件里面的提示：</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#error iOSOpenDev post-project creation from template requirements (remove these lines after completed) -- \</span></div><div class="line">Link to libsubstrate.<span class="symbol">dylib:</span> \</div><div class="line">(<span class="number">1</span>) go to TARGETS &gt; Build Phases &gt; Link Binary With Libraries and add /opt/iOSOpenDev/<span class="class"><span class="keyword">lib</span>/<span class="title">libsubstrate</span>.<span class="title">dylib</span> \</span></div><div class="line">(<span class="number">2</span>) remove these lines from *.xm files (not *.mm files <span class="keyword">as</span> they<span class="string">'re automatically generated from *.xm files)</span></div></pre></td></tr></table></figure>
<p>按照以上提示去操作编译就能通过了。</p>
<p>新建一个控制器<code>EncryptionViewController</code> 用来显示我们所有的联系人，其中<code>ContactsDataLogic.h、CContact.h、CBaseContact.h</code>使我们引用的微信中的头文件。项目结构如下：</p>
<p><img src="https://github.com/wmf00032/imagesRecource/blob/master/wechat2_images/%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%875.png?raw=true" alt=""></p>
<p>现在开始写我们自己的代码，<code>TestWeChat.xm</code>里面的代码如下：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"EncryptionViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="built_in">UIBarButtonItem</span> *leftBarItem;</div><div class="line">%hook NewMainFrameViewController</div><div class="line"></div><div class="line">%new</div><div class="line">- (<span class="keyword">void</span>)encryptionLeftItemClickBtn&#123;</div><div class="line">    </div><div class="line">    <span class="built_in">UIViewController</span> *controller = (<span class="built_in">UIViewController</span>*)<span class="keyword">self</span>;</div><div class="line">    <span class="comment">/* 进入加密名单列表 */</span></div><div class="line">    EncryptionViewController *encryptionController = [[EncryptionViewController alloc] initWithStyle:<span class="built_in">UITableViewStyleGrouped</span>];</div><div class="line">    encryptionController.hidesBottomBarWhenPushed = <span class="literal">YES</span>;</div><div class="line">    [controller.navigationController pushViewController:encryptionController animated:<span class="literal">YES</span>];</div><div class="line">    [encryptionController release];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidAppear:(<span class="built_in">BOOL</span>)animated&#123;</div><div class="line">    </div><div class="line">    %orig;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span>(!leftBarItem)&#123;</div><div class="line">        <span class="built_in">UIButton</span> *leftBtn = [[<span class="built_in">UIButton</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">55</span>, <span class="number">44</span>)];</div><div class="line">        [leftBtn setTitleColor:[<span class="built_in">UIColor</span> whiteColor] forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line">        leftBtn.titleLabel.font = [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">13</span>];</div><div class="line">        [leftBtn setTitle:<span class="string">@"爱你加密"</span> forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line">        [leftBtn addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(encryptionLeftItemClickBtn) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</div><div class="line">        </div><div class="line">        leftBarItem = [[<span class="built_in">UIBarButtonItem</span> alloc] initWithCustomView:leftBtn];</div><div class="line">    &#125;</div><div class="line">    [[<span class="keyword">self</span> navigationItem] setLeftBarButtonItem:leftBarItem];</div><div class="line">    </div><div class="line">&#125;</div><div class="line">%end</div></pre></td></tr></table></figure>
<p>这里特别值得说明首页新增加的<code>leftBtn</code>放在<code>viewDidAppear</code>方法中，这是因为经过本人反复尝试发现，如果直接放在<code>viewDidLoad</code>方法中创建，微信将会在后面更新界面的时候将其冲刷掉。读者可以自己亲自试验一下，虽然这里看起来很怪！</p>
<p><code>EncryptionViewController.m</code> 的实现代码如下：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"EncryptionViewController.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"ContactsDataLogic.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"CContact.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EncryptionViewController</span> ()</span></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">EncryptionViewController</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSArray</span> *_contactsArray;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    ContactsDataLogic *contactsDataLogic = [[<span class="built_in">NSClassFromString</span>(<span class="string">@"ContactsDataLogic"</span>) alloc] initWithScene:<span class="number">0</span></div><div class="line">                                                                                                 delegate:<span class="literal">nil</span>];</div><div class="line">    _contactsArray = [contactsDataLogic getAllContacts];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">#pragma mark - Table view data source</span></div><div class="line"></div><div class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section &#123;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> _contactsArray.count;</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">54</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    </div><div class="line">    <span class="built_in">UITableViewCell</span>* cell = [tableView dequeueReusableCellWithIdentifier:<span class="string">@"cellIdentifier"</span>];</div><div class="line">    <span class="keyword">if</span> (cell == <span class="literal">nil</span>) &#123;</div><div class="line">        cell = [[<span class="built_in">UITableViewCell</span> alloc] initWithStyle:<span class="built_in">UITableViewCellStyleDefault</span> reuseIdentifier:<span class="string">@"cellIdentifier"</span>];</div><div class="line">    &#125;</div><div class="line">    CContact *contact = _contactsArray[indexPath.row];</div><div class="line">    cell.textLabel.text = contact.m_nsNickName;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> cell;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>是的，代码非常少，相信大家一看就明白!</p>
<p>接下来按<code>command+B</code> 编译后生成 <code>TestWeChat.dylib</code> 动态库，找到动态库存放目录，如下：</p>
<p><img src="https://github.com/wmf00032/imagesRecource/blob/master/wechat2_images/%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%876.png?raw=true" width="320" height="568" alt="图片名称" align="center"></p>
<p><img src="https://github.com/wmf00032/imagesRecource/blob/master/wechat2_images/%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%877.png?raw=true" alt=""></p>
<p><code>otool、testbs.sh、WeChat</code>文件是我<code>copy</code>进来的。 其中<code>WeChat</code>是二进制文件，<code>otool</code> 是是动态库插入工具（类似的工具还有<code>yololib、insert_dylib</code> 等），<code>testbs.sh</code>是我自己写的脚本，只要在终端运行：<code>bash testbs.sh</code>就会自动将动态库<code>TestWeChat.dylib</code>进行签名，然后注入<code>WeChat</code>二进制文件，再将<code>WeChat</code>二进制文件重新签名打包成  <code>.ipa</code>包，最后自动安装到手机。</p>
<p>安装后像这个样子：</p>
<p><img src="https://github.com/wmf00032/imagesRecource/blob/master/wechat2_images/%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%878.png?raw=true" width="320" height="568" alt="图片名称" align="center"></p>
<p><img src="https://github.com/wmf00032/imagesRecource/blob/master/wechat2_images/%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%879.png?raw=true" width="320" height="568" alt="图片名称" align="center"></p>
<h1 id="一键自动化脚本"><a href="#一键自动化脚本" class="headerlink" title="一键自动化脚本"></a>一键自动化脚本</h1><p>下面来解释一下上面提到的自动化脚本，先看一下<code>testbs.sh</code>文件如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#!bash</span></div><div class="line"></div><div class="line"><span class="comment">#set -e</span></div><div class="line"></div><div class="line"><span class="comment"># 注意变量赋值=左右不能有空格</span></div><div class="line"><span class="comment">## 项目路径</span></div><div class="line">PROJECT_PATH=/Users/wangmengfa/Library/Developer/Xcode/DerivedData/TestWeChat-fbcbnefjbnbhkaclrzsccyotvlzq/Build/Products/Debug-iphoneos</div><div class="line"><span class="comment"># dylib name</span></div><div class="line">DYLIB_NAME=TestWeChat.dylib</div><div class="line"><span class="comment"># dylib path</span></div><div class="line">DYLIB_PATH=<span class="variable">$&#123;PROJECT_PATH&#125;</span>/<span class="variable">$&#123;DYLIB_NAME&#125;</span></div><div class="line"><span class="comment">#/obj/</span></div><div class="line"><span class="comment"># 要插入的 .app 名称，列入这儿是：WeChat.app</span></div><div class="line">TERGET_APP_NAME=WeChat</div><div class="line"></div><div class="line"><span class="comment">## 进行签名的密钥</span></div><div class="line">DIST_SIGN=<span class="string">'iPhone Distribution: BeiJing XXXX'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="built_in">cd</span> <span class="variable">$&#123;PROJECT_PATH&#125;</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"项目："</span></div><div class="line"><span class="built_in">pwd</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> [ <span class="_">-f</span> <span class="string">"<span class="variable">$&#123;DYLIB_PATH&#125;</span>"</span> ];</div><div class="line"><span class="keyword">then</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"file exist !"</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"this file path: <span class="variable">$&#123;DYLIB_PATH&#125;</span>"</span></div><div class="line"><span class="keyword">else</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;DYLIB_NAME&#125;</span> file not exit !"</span></div><div class="line"><span class="built_in">exit</span> -1</div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#卸载之前的dylib(先判断是否存在)</span></div><div class="line"></div><div class="line">install_bylib=<span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.app/<span class="variable">$&#123;DYLIB_NAME&#125;</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> [ <span class="_">-f</span> <span class="string">"<span class="variable">$&#123;install_bylib&#125;</span>"</span> ];</div><div class="line"><span class="keyword">then</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;install_bylib&#125;</span> aready file exist !"</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"this file path: <span class="variable">$&#123;install_bylib&#125;</span>"</span></div><div class="line"></div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"---start----uninstall <span class="variable">$&#123;DYLIB_NAME&#125;</span>"</span></div><div class="line">./optool uninstall -p <span class="string">"@executable_path/<span class="variable">$&#123;DYLIB_NAME&#125;</span>"</span> -t <span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.app/<span class="variable">$&#123;TERGET_APP_NAME&#125;</span></div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"---success----卸载之前dylib\n"</span></div><div class="line"></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="comment"># copy最新的</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"copy <span class="variable">$&#123;DYLIB_NAME&#125;</span> to <span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.app"</span></div><div class="line">cp -rf <span class="variable">$&#123;DYLIB_PATH&#125;</span> <span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.app/</div><div class="line"><span class="built_in">echo</span> <span class="string">"copy success!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 动态库插入</span></div><div class="line">./optool install -c load -p <span class="string">"@executable_path/<span class="variable">$&#123;DYLIB_NAME&#125;</span>"</span> -t <span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.app/<span class="variable">$&#123;TERGET_APP_NAME&#125;</span></div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"---success----动态库插入\n"</span></div><div class="line"></div><div class="line"><span class="comment"># 动态库签名</span></div><div class="line">codesign <span class="_">-f</span> <span class="_">-s</span> <span class="variable">$&#123;DIST_SIGN&#125;</span> <span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.app/<span class="variable">$&#123;DYLIB_NAME&#125;</span></div><div class="line"></div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"---success----动态库签名完成\n"</span></div><div class="line"></div><div class="line"><span class="comment"># app签名</span></div><div class="line">codesign <span class="_">-f</span> <span class="_">-s</span> <span class="variable">$&#123;DIST_SIGN&#125;</span> --entitlements Entitlements.plist <span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.app</div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"---success----app签名完成\n"</span></div><div class="line"></div><div class="line"><span class="comment"># 生成ipa包</span></div><div class="line"><span class="built_in">echo</span> <span class="variable">$&#123;MYHOME_PATH&#125;</span>/<span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.app</div><div class="line">xcrun -sdk iphoneos PackageApplication -v <span class="variable">$&#123;MYHOME_PATH&#125;</span>/<span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.app <span class="variable">$&#123;MYHOME_PATH&#125;</span>/<span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.ipa</div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"---success----生成ipa包\n"</span></div><div class="line"></div><div class="line"><span class="comment"># 安装</span></div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"---start install ipa----"</span></div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"---wait a moment----"</span></div><div class="line">mobiledevice install_app <span class="variable">$&#123;MYHOME_PATH&#125;</span>/<span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.ipa</div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"---success----安装完成！\n"</span></div></pre></td></tr></table></figure>
<p>其中<code>PROJECT_PATH</code>是当前动态库和<code>WeChat</code>二进制文件所在的目录，<code>DYLIB_NAME</code>是待注入动态库的名称，<code>TERGET_APP_NAME</code>是待注入二进制文件的名称，这里的<code>TERGET_APP_NAME</code>就是<code>WeChat</code>.</p>
<p>其中脚本：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">if</span> [ <span class="_">-f</span> <span class="string">"<span class="variable">$&#123;install_bylib&#125;</span>"</span> ];</div><div class="line"><span class="keyword">then</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;install_bylib&#125;</span> aready file exist !"</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"this file path: <span class="variable">$&#123;install_bylib&#125;</span>"</span></div><div class="line"></div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"---start----uninstall <span class="variable">$&#123;DYLIB_NAME&#125;</span>"</span></div><div class="line">./optool uninstall -p <span class="string">"@executable_path/<span class="variable">$&#123;DYLIB_NAME&#125;</span>"</span> -t <span class="variable">$&#123;TERGET_APP_NAME&#125;</span>.app/<span class="variable">$&#123;TERGET_APP_NAME&#125;</span></div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"---success----卸载之前dylib\n"</span></div><div class="line"></div><div class="line"><span class="keyword">fi</span></div></pre></td></tr></table></figure>
<p>在注入动态库文件之前，先检测当前二进制文件中是否已经包含了改动态库，如果已经包含了就先卸载之前的，如果没有包含就直接注入。</p>
<p>注入之后一定记得要将动态库和二进制文件进行签名，最后使用  <code>mobiledevice</code> 工具 将新生成的 .ipa包安装到手机上面（你也可以选择使用 <code>Itunes</code> 进行安装）。</p>
<p><strong>郑重声明：未经本人允许严禁任何个人或组织转载！</strong></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2016/09/06/wechat-secret-2/" data-id="cit06qt370004afagw56sxzn8" class="article-share-link">分享到</a><div class="tags"></div><div class="post-nav"><a href="/2016/09/06/wechat-secret-3/" class="pre">（非越狱版）iOS微信聊天加密插件 （三）</a><a href="/2016/09/06/wechat-secret/" class="next">（非越狱版）iOS微信聊天加密插件 （一）</a></div><div data-thread-key="2016/09/06/wechat-secret-2/" data-title="（非越狱版）iOS微信聊天加密插件 （二）" data-url="http://yoursite.com/2016/09/06/wechat-secret-2/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/09/06/wechat-secret-2/" data-title="（非越狱版）iOS微信聊天加密插件 （二）" data-url="http://yoursite.com/2016/09/06/wechat-secret-2/" data-author-key="1" class="ds-thread"></div><div id="disqus_thread"><script>var disqus_shortname = 'wmf00032-github-io';
var disqus_identifier = '2016/09/06/wechat-secret-2/';
var disqus_title = '（非越狱版）iOS微信聊天加密插件 （二）';
var disqus_url = 'http://yoursite.com/2016/09/06/wechat-secret-2/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//wmf00032-github-io.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://yoursite.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/09/12/dylib1/">mac和iPhone命令生成可执行文件的区别</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/06/wechat-secret-4/">（非越狱版）iOS微信聊天加密插件 （四）终结篇</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/06/wechat-secret-3/">（非越狱版）iOS微信聊天加密插件 （三）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/06/wechat-secret-2/">（非越狱版）iOS微信聊天加密插件 （二）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/06/wechat-secret/">（非越狱版）iOS微信聊天加密插件 （一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/12/afnetworking-know-what/">AFNetWorking 深度理解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/09/my-new-wmf/">iOS 基于AVPLayer封装视频播放器</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//wmf00032-github-io.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">王孟发.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'wmf00032'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>